<div class="upload-container">
  <mat-card class="header-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>upload_file</mat-icon>
        Trainingsplan hochladen
      </mat-card-title>
      <mat-card-subtitle *ngIf="competition">
        f체r {{ competition.name }} ({{ competition.targetDate ? formatDate(competition.targetDate) : 'Kein Datum' }})
      </mat-card-subtitle>
    </mat-card-header>
  </mat-card>

  <div class="upload-content">
    <!-- Template Download Section -->
    <mat-card class="template-card">
      <mat-card-content>
        <div class="template-info">
          <mat-icon class="info-icon">info</mat-icon>
          <div>
            <h3>JSON Trainingsplan Format</h3>
            <p>Laden Sie eine Vorlage herunter oder erstellen Sie einen eigenen JSON-Trainingsplan</p>
          </div>
        </div>
        
        <button mat-raised-button color="accent" (click)="downloadTemplate()">
          <mat-icon>download</mat-icon>
          Vorlage herunterladen
        </button>
      </mat-card-content>
    </mat-card>

    <mat-divider></mat-divider>

    <!-- File Upload Section -->
    <mat-card class="upload-card">
      <mat-card-content>
        <!-- Drag & Drop Area -->
        <div 
          class="drop-zone" 
          [class.drag-over]="dragOver"
          (dragover)="onDragOver($event)"
          (dragleave)="onDragLeave($event)"
          (drop)="onDrop($event)"
          *ngIf="!selectedFile">
          
          <mat-icon class="upload-icon">cloud_upload</mat-icon>
          <h3>Datei hier ablegen</h3>
          <p>oder klicken Sie zum Ausw채hlen</p>
          
          <input 
            type="file" 
            accept=".json,application/json" 
            (change)="onFileSelected($event)"
            #fileInput
            style="display: none;">
          
          <button mat-raised-button color="primary" (click)="fileInput.click()">
            <mat-icon>folder_open</mat-icon>
            Datei ausw채hlen
          </button>
        </div>

        <!-- Selected File Display -->
        <div class="selected-file" *ngIf="selectedFile">
          <mat-icon class="file-icon">description</mat-icon>
          <div class="file-info">
            <h4>{{ selectedFile.name }}</h4>
            <p>{{ (selectedFile.size / 1024 / 1024).toFixed(2) }} MB</p>
          </div>
          <button mat-icon-button color="warn" (click)="removeFile()">
            <mat-icon>close</mat-icon>
          </button>
        </div>

        <!-- Upload Progress -->
        <div class="upload-progress" *ngIf="uploading">
          <mat-progress-bar mode="indeterminate"></mat-progress-bar>
          <p>Trainingsplan wird hochgeladen...</p>
        </div>
      </mat-card-content>
      
      <mat-card-actions *ngIf="selectedFile && !uploading">
        <button mat-button (click)="cancel()">
          <mat-icon>cancel</mat-icon>
          Abbrechen
        </button>
        
        <button mat-raised-button color="primary" (click)="uploadFile()">
          <mat-icon>upload</mat-icon>
          Hochladen
        </button>
      </mat-card-actions>
    </mat-card>

    <!-- Format Documentation -->
    <mat-card class="documentation-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>help_outline</mat-icon>
          JSON Format Dokumentation
        </mat-card-title>
      </mat-card-header>
      
      <mat-card-content>
        <div class="format-section">
          <h4>Trainingstypen:</h4>
          <div class="tags">
            <span class="tag" *ngFor="let type of trainingTypes">
              {{ type.label }} ({{ type.value }})
            </span>
          </div>
        </div>

        <mat-divider></mat-divider>

        <div class="format-section">
          <h4>Intensit채tsstufen:</h4>
          <div class="tags">
            <span class="tag" *ngFor="let intensity of intensityLevels">
              {{ intensity.label }} ({{ intensity.value }})
            </span>
          </div>
        </div>

        <mat-divider></mat-divider>

        <div class="format-section">
          <h4>Beispiel-Struktur:</h4>
          <pre class="json-example">{{ getFormattedExample() }}</pre>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
